<div class="flex flex-col gap-1">

<div>
  <p-tabView (activeIndexChange)="tabChanged($event)" [activeIndex]="activeIndex">
      <div class="flex flex-row justify-between" *ngIf="activeIndex !== 2">
        <span class="flex flex-col">
          <h4 class="text-[#0277BD] mr-3">
            Recommendation based on the following concepts:
          </h4>
          <div class="flex flex-wrap gap-1 w-9/12"> 
            <button
              *ngFor="let concept of allConceptsObj"
              class="dislike-button {{concept.status === 'understood' ? 'bg-[#689F38]' : concept.status === 'notUnderstood' ? 'bg-[#D32F2F]' : 'bg-[#2196F3]'}}
              text-white px-2 mx-1 border border-transparent rounded-full"
            >
              {{ concept.name }}
              <button
                #notUnderstoodConcept
                class="bg-transparent hover focus:outline-none cursor-pointer"
                (click)="setChipConcept(concept); menu.toggle($event)"
              >
                <svg class="w-1 h-1 mt-0.5 ml-1.5">
                  <circle
                    cx="2.5"
                    cy="2.5"
                    r="2"
                    style="fill: white; stroke: #495057; stroke: width 0.5px"
                  />
                </svg>
                <svg class="w-1 h-1 mt-0.5 ml-1.5">
                  <circle
                    cx="2.5"
                    cy="2.5"
                    r="2"
                    style="fill: white; stroke: #495057; stroke: width 0.5px"
                  />
                </svg>
                <svg class="w-1 h-1 mt-0.5 ml-1.5">
                  <circle
                    cx="2.5"
                    cy="2.5"
                    r="2"
                    style="fill: white; stroke: #495057; stroke: width 0.5px"
                  />
                </svg>
                <p-menu
                  #menu
                  id="notUnderstood_menu"
                  [model]="concept.status === 'notUnderstood' ? chipMenuU : concept.status === 'understood' ? chipMenuDNU : chipMenuNew"
                  [popup]="true"
                  appendTo="body"
                ></p-menu>
              </button>
            </button>
          </div>
          <!-- <div
            id="materialModelDropdown"
            class="p-field-dropdown"
            style="display: block;margin-left: auto;margin-right: 0;"
          >
            <p-dropdown
              [options]="materialModels"
              [(ngModel)]="selectedMaterialModel"
              optionLabel="name"
              optionValue="code"
              (onChange)="loadResultForSelectedModel(selectedMaterialModel)"
            ></p-dropdown>
          </div> -->
        </span>

        <div id="cro_sorting" class="w-3/12"></div>

        <div id="cro_sorting" class="w-3/12">
          <p-panel 
            header="Sort by" 
            [toggleable]="true"
            [collapsed]="true"
            [expandIcon]="'pi pi-chevron-up'" 
            [collapseIcon]="'pi pi-chevron-down'"
          >
            <div class="flex flex-col">
              <!-- <div style="height: 2rem;"><p-divider></p-divider></div> -->
              <div class="flex flex-row space-x-2">
                <div><p-checkbox 
                  [(ngModel)]="croSorting.similarity_score.status" [binary]="true" inputId="similarity_score"
                  (onChange)="sortResourcesByKeys('')"
                  ></p-checkbox>
                </div>
                <div class="my-auto"><label for="similarity_score">Similarity Score</label></div>
                <div class="flex flex-row space-x-2 pl-4">
                  <button (click)="sortResourcesByKeys('similarity_score')">
                    <div *ngIf="croSorting.similarity_score.arrow === true">
                      <span class="pi pi-arrow-up" style="font-size: 1.2rem"></span>
                    </div>
                    <div *ngIf="croSorting.similarity_score.arrow === false">
                      <span class="pi pi-arrow-down" style="font-size: 1.2rem"></span>
                    </div>
                  </button>
                </div>
              </div>
  
              <div style="height: 2rem;"><p-divider></p-divider></div>
              <div class="flex flex-row space-x-2">
                <div><p-checkbox [(ngModel)]="croSorting.publish_time.status" [binary]="true" inputId="publish_time"
                  (onChange)="sortResourcesByKeys('')"
                  ></p-checkbox></div>
                <div class="my-auto"><label for="publish_time">Most recent</label></div>
                <div class="flex flex-row space-x-2 pl-11">
                  <button (click)="sortResourcesByKeys('publish_time')">
                    <div *ngIf="croSorting.publish_time.arrow === true">
                      <span class="pi pi-arrow-up" style="font-size: 1.2rem"></span>
                    </div>
                    <div *ngIf="croSorting.publish_time.arrow === false">
                      <span class="pi pi-arrow-down" style="font-size: 1.2rem"></span>
                    </div>
                  </button>
                </div>
              </div>
  
              <div style="height: 2rem;"><p-divider></p-divider></div>
              <div class="flex flex-row space-x-2">
                <div><p-checkbox [(ngModel)]="croSorting.views.status" [binary]="true" inputId="views"
                  (onChange)="sortResourcesByKeys('')"
                  ></p-checkbox></div>
                <div class="my-auto"><label for="views">Popularity</label></div>
                <div class="flex flex-row space-x-2 pl-12">
                  <button (click)="sortResourcesByKeys('views')">
                    <div *ngIf="croSorting.views.arrow === true">
                      <span class="pi pi-arrow-up" style="font-size: 1.2rem"></span>
                    </div>
                    <div *ngIf="croSorting.views.arrow === false">
                      <span class="pi pi-arrow-down" style="font-size: 1.2rem"></span>
                    </div>
                  </button>
                </div>
              </div>
            </div>
          </p-panel>
        </div>
      </div>

      <p-tabPanel *ngIf="resourcesPagination.nodes.videos" [cache]="true" header="Videos" leftIcon="pi pi-video">
        <div class="mt-1 w-full" id="cro_viedo_list">

          <!-- <p-scrollPanel styleClass="scroll_panel_list">
            <app-card-video-list
              [notUnderstoodConcepts]="concepts"
              [videoElements]="croVideos?.content"
            ></app-card-video-list>
          </p-scrollPanel> -->

            <app-card-video-list
              [notUnderstoodConcepts]="concepts"
              [videoElements]="resourcesPagination.nodes.videos"
            ></app-card-video-list>
        </div>
      </p-tabPanel>
      <p-tabPanel *ngIf="!resourcesPagination.nodes.videos" header="Videos" leftIcon="pi pi-video">
        <h4 class="my-auto mt-4">No Recommended videos for the selected Concepts</h4>
      </p-tabPanel>
      <p-tabPanel *ngIf="resourcesPagination.nodes.articles" [cache]="true" header="Articles" leftIcon="pi pi-book">
        <div>

          <!-- <p-scrollPanel styleClass="scroll_panel_list">
            <app-card-article-list
              [notUnderstoodConcepts]="concepts"
              [articleElements]="croArticles?.content"
            ></app-card-article-list>
          </p-scrollPanel> -->

            <app-card-article-list
              [notUnderstoodConcepts]="concepts"
              [articleElements]="resourcesPagination.nodes.articles"
            ></app-card-article-list>
        </div>
      </p-tabPanel>
      <p-tabPanel *ngIf="!resourcesPagination.nodes.articles" header="Articles" leftIcon="pi pi-book">
        <h4 class="my-auto mt-4">No Recommended articles for the selected Concepts</h4>
      </p-tabPanel>

      <!-- display resources saved and offer filtering possibility -->
      <p-tabPanel header="Saved" leftIcon="pi pi-bookmark">
        <div class="flex flex-row justify-between">
          <div class="flex flex-row gap-4">
            <div class="my-auto">Content type:</div>
            <div class="flex flex-row gap-4">
              <div class="flex flex-row my-auto">
                <p-radioButton name="video" value="video" [(ngModel)]="filteringParamsSavedTab.content_type" inputId="video"
                (onClick)="onContentTypeChange($event)"
                >
                </p-radioButton>
                <label for="video" class="ml-1">Video</label>
              </div>
              <div class="flex flex-row my-auto">
                <p-radioButton name="article" value="article" [(ngModel)]="filteringParamsSavedTab.content_type" inputId="article"
                (onClick)="onContentTypeChange($event)"
                >
                </p-radioButton>
                <label for="article" class="ml-1">Article</label>
              </div>
            </div>
          </div>

          <div>
            <span class="p-input-icon-right">
              <i class="pi pi-search" *ngIf="!showSearchIconPinner"></i>
              <i class="pi pi-spin pi-spinner" *ngIf="showSearchIconPinner"></i>
              <input type="text" pInputText [(ngModel)]="filteringParamsSavedTab.text" 
                (input)="filteringResourcesSaved()"
              />
            </span>
          </div>
        </div>

        <!-- <div class="flex flex-col">
          <div>Filter by:</div>
          <div class="flex flex-row justify-between">
            <div class="w4/12">

              <p-dropdown
              [options]="resourcesSaved?.cids"
              [(ngModel)]="mainConceptSelected"
              optionLabel="name"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              placeholder="Main Concept(s)"
              emptyFilterMessage="No Concept found"
              (onChange)="selectFilteringParamsOnChange($event, 1)"
              [resetFilterOnHide]="true"
              [style]="{'width': '20rem'}"
              >
                <ng-template pTemplate="selectedItem">
                    <div class="flex align-items-center gap-2" *ngIf="mainConceptSelected">
                        <div>{{ mainConceptSelected.name }}</div>
                    </div>
                </ng-template>
                <ng-template let-main_concept pTemplate="item">
                    <div class="flex align-items-center gap-2">
                        <div class="my-auto"><p-checkbox [(ngModel)]="main_concept.status" [binary]="true" inputId="binary"></p-checkbox></div>
                        <div class="my-auto">{{ main_concept.name }}</div>
                    </div>
                </ng-template>
              </p-dropdown>

            </div>

            <div>lm</div>
            <div>sl</div>
          </div>
          <div class="flex flex-row">
            <div>Content type:</div>
            <div>radio</div>
          </div>
          <div>
            Resources List
          </div>
        </div> -->
      </p-tabPanel>

  </p-tabView>
  <p-toast position="bottom-left" key="rating"></p-toast>
</div>

<!-- Pagination UI -->
<!-- <div>
    <div class="flex justify-end fixed inset-x-0 bottom-0 bg-white">
      <div class="my-auto font-bold text-xs">Recommendations per page: </div>
      <div>
        <p-paginator
          *ngIf="activeIndex === 0"
          [first]="croPaginatorFirst" 
          [rows]="1" 
          [totalRecords]="croVideos.length" 
          (onPageChange)="croOnPageChange($event)" 
          [showJumpToPageDropdown]="true" 
          [showPageLinks]="false"
        ></p-paginator>

        <p-paginator
          *ngIf="activeIndex === 1"
          [first]="croPaginatorFirst" 
          [rows]="1" 
          [totalRecords]="croArticles.total_pages" 
          (onPageChange)="croOnPageChange($event)" 
          [showJumpToPageDropdown]="true" 
          [showPageLinks]="false"
        ></p-paginator>
      </div>
    </div>
</div> -->

</div>